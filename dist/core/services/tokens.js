"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Tokens=void 0;const jsonwebtoken_1=require("jsonwebtoken"),uuid_1=require("uuid"),parameters_1=require("../parameters/parameters");class Tokens{static generateAccessToken(e,r=!1){const{userId:s,name:t,lastname:n,roles:a}=e.properties,o={userId:s,name:t,lastname:n,roles:a,enable2FA:r};return(0,jsonwebtoken_1.sign)(o,parameters_1.Parameters.jwtSecret,{expiresIn:parameters_1.Parameters.jwtExpiresIn})}static generateRefreshToken(){return(0,uuid_1.v4)()}static generateTokens(e,r=!1){return{accessToken:this.generateAccessToken(e,r),refreshToken:e.properties.refreshToken}}static verifyToken(e){return new Promise(((r,s)=>{(0,jsonwebtoken_1.verify)(e,parameters_1.Parameters.jwtSecret,((e,t)=>e?s(e):r(t)))}))}}exports.Tokens=Tokens;